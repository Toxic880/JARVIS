<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>JARVIS Quick Command</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: transparent;
      -webkit-app-region: drag;
    }
    
    .container {
      background: rgba(10, 10, 20, 0.95);
      border: 1px solid rgba(14, 165, 233, 0.3);
      border-radius: 12px;
      padding: 16px;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(20px);
    }
    
    .input-wrapper {
      display: flex;
      align-items: center;
      gap: 12px;
      -webkit-app-region: no-drag;
    }
    
    .icon {
      width: 32px;
      height: 32px;
      fill: #0ea5e9;
    }
    
    input {
      flex: 1;
      background: transparent;
      border: none;
      outline: none;
      font-size: 18px;
      color: #fff;
      font-weight: 300;
    }
    
    input::placeholder {
      color: rgba(255, 255, 255, 0.3);
    }
    
    .hint {
      font-size: 11px;
      color: rgba(255, 255, 255, 0.3);
      margin-top: 8px;
      text-align: right;
    }
    
    kbd {
      background: rgba(255, 255, 255, 0.1);
      padding: 2px 6px;
      border-radius: 4px;
      font-family: inherit;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="input-wrapper">
      <svg class="icon" viewBox="0 0 100 100">
        <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3"/>
        <circle cx="50" cy="50" r="30" fill="none" stroke="currentColor" stroke-width="2" opacity="0.5"/>
        <circle cx="50" cy="50" r="15" fill="currentColor" opacity="0.8"/>
      </svg>
      <input 
        type="text" 
        id="command" 
        placeholder="Ask JARVIS anything..."
        autofocus
      />
    </div>
    <div class="hint">Press <kbd>Enter</kbd> to send â€¢ <kbd>Esc</kbd> to close</div>
  </div>
  
  <script>
    const input = document.getElementById('command');
    
    input.addEventListener('keydown', async (e) => {
      if (e.key === 'Enter' && input.value.trim()) {
        const command = input.value.trim();
        
        // Send to main window
        try {
          const response = await fetch('http://localhost:3001/api/v1/llm/chat', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': `Bearer ${localStorage.getItem('jarvis_token') || ''}`,
            },
            body: JSON.stringify({
              message: command,
              conversationId: 'quick',
            }),
          });
          
          if (response.ok) {
            const data = await response.json();
            // Show notification with response
            if (window.jarvis) {
              window.jarvis.showNotification('JARVIS', data.response || data.message);
            }
          }
        } catch (err) {
          console.error('Quick command error:', err);
        }
        
        window.close();
      }
      
      if (e.key === 'Escape') {
        window.close();
      }
    });
  </script>
</body>
</html>
